<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">ProfitAI.io - Intelligence Artificielle Trading</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #0a0a0a; color: #fff; font-family: 'Segoe UI', sans-serif; }
        .neon-green { text-shadow: 0 0 5px #00ff88, 0 0 10px #00ff88; }
        .candlestick { background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjUwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iNTAiIGZpbGw9IiMwYTBhMGEiLz48bGluZSB4MT0iNTAiIHkxPSIwIiB4Mj0iNTAiIHkyPSI1MCIgc3Ryb2tlPSIjMDBmZjg4IiBzdHJva2Utd2lkdGg9IjEiLz48L3N2Zz4='); }
        .trading-panel { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); }
        .buy-btn { background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%); }
        .sell-btn { background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%); }
        .pulse-animation { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<!-- BANDEAU L√âGAL FIXE -->
<div class="bg-red-900 text-yellow-300 p-3 text-center text-sm font-bold fixed top-0 w-full z-50" id="legal-banner">
    ‚ö†Ô∏è MODE D√âMONSTRATION - TRADING SIMUL√â - PAS DE CONSEIL FINANCIER
</div>

<!-- NAVIGATION -->
<nav class="p-5 bg-gray-900 border-b-2 border-green-500 mt-12">
    <div class="container mx-auto flex justify-between items-center">
        <div class="flex items-center">
            <img src="https://raw.githubusercontent.com/RusAfrixConnect/ProfitAI/main/WhatsApp-Image-2025-11-12-at-17.12.50.png" 
                 alt="ProfitAI Logo" 
                 class="h-12 mr-4">
            <h1 class="text-3xl font-bold neon-green">ProfitAI.io</h1>
        </div>
        <div class="flex gap-4">
            <select id="lang-select" class="bg-gray-800 px-3 py-2 rounded border border-green-500">
                <option value="fr">üá´üá∑ FR</option>
                <option value="en">üá¨üáß EN</option>
                <option value="ru">üá∑üá∫ RU</option>
            </select>
        </div>
    </div>
</nav>

<!-- HERO ZND -->
<section class="container mx-auto p-8">
    <div class="bg-gradient-to-r from-purple-900 via-green-900 to-blue-900 p-8 rounded-lg border-2 border-green-500">
        <h2 class="text-5xl font-bold mb-4">üöÄ ZND Token by MineralX</h2>
        <p class="text-xl mb-6" id="znd-description">La premi√®re crypto-monnaie index√©e sur des min√©raux r√©els</p>
        
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
            <div class="bg-black/50 p-5 rounded">
                <p class="text-gray-400 text-sm" id="price-label">Prix ZND</p>
                <p id="znd-price" class="text-3xl font-bold neon-green">$0.0025</p>
                <p class="text-green-400 text-sm">+5.42% 24h</p>
            </div>
            <div class="bg-black/50 p-5 rounded">
                <p class="text-gray-400 text-sm">Market Cap</p>
                <p id="znd-mcap" class="text-3xl font-bold">$2.5M</p>
            </div>
            <div class="bg-black/50 p-5 rounded">
                <p class="text-gray-400 text-sm">Volume 24h</p>
                <p id="znd-volume" class="text-3xl font-bold">$45,230</p>
                <p class="text-red-400 text-sm">-12% (correction)</p>
            </div>
            <div class="bg-black/50 p-5 rounded">
                <p class="text-gray-400 text-sm">Min√©raux Backed</p>
                <p class="text-3xl font-bold text-blue-400">10M tonnes</p>
            </div>
        </div>

        <div class="flex gap-4">
            <button id="znd-buy-btn" onclick="window.open('https://mineralx.io/#tokens', '_blank')" 
                    class="px-8 py-4 bg-green-600 rounded-lg text-xl font-bold hover:bg-green-700">
                Acheter ZND sur MineralX
            </button>
            <button onclick="window.open('https://testnet.bscscan.com/token/0x1Df4841EB4B94436EAD4a922ecBE03Aa8bA2cF6C', '_blank')" 
                    class="px-8 py-4 bg-blue-600 rounded-lg text-xl font-bold hover:bg-blue-700">
                Voir sur BSCScan
            </button>
        </div>
    </div>
</section>

<!-- SECTION TRADING SIMUL√â -->
<section class="container mx-auto p-8">
    <h2 class="text-4xl font-bold mb-8 text-center text-blue-400" id="trading-title">üíπ Plateforme de Trading Simul√©</h2>
    
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
        <!-- PANEL DE TRADING -->
        <div class="lg:col-span-3 trading-panel p-6 rounded-lg border-2 border-blue-500">
            <h3 class="text-2xl font-bold mb-6 text-blue-400" id="trade-panel-title">Ex√©cuter un Trade</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- SELECTION ASSET -->
                <div>
                    <label class="block text-gray-400 mb-2" id="asset-label">Actif √† trader</label>
                    <select id="asset-select" class="w-full bg-gray-800 p-3 rounded border border-green-500">
                        <option value="ZND">ZND/USDT</option>
                        <option value="BTC">BTC/USDT</option>
                        <option value="ETH">ETH/USDT</option>
                        <option value="BNB">BNB/USDT</option>
                    </select>
                </div>
                
                <!-- TYPE D'ORDRE -->
                <div>
                    <label class="block text-gray-400 mb-2" id="order-type-label">Type d'ordre</label>
                    <select id="order-type" class="w-full bg-gray-800 p-3 rounded border border-green-500">
                        <option value="market">Ordre au March√©</option>
                        <option value="limit">Ordre Limite</option>
                    </select>
                </div>
                
                <!-- PRIX (visible seulement pour ordre limite) -->
                <div id="price-input-container" class="hidden">
                    <label class="block text-gray-400 mb-2" id="price-label-trade">Prix Limite (USDT)</label>
                    <input type="number" id="limit-price" class="w-full bg-gray-800 p-3 rounded border border-green-500" step="0.0001">
                </div>
                
                <!-- QUANTIT√â -->
                <div>
                    <label class="block text-gray-400 mb-2" id="quantity-label">Quantit√©</label>
                    <input type="number" id="quantity" class="w-full bg-gray-800 p-3 rounded border border-green-500" value="0" min="0" step="0.001">
                </div>
            </div>
            
            <!-- BOUTONS BUY/SELL -->
            <div class="grid grid-cols-2 gap-4 mt-6">
                <button id="buy-btn" class="buy-btn p-4 rounded-lg text-xl font-bold text-white">
                    <i class="fas fa-arrow-up mr-2"></i> <span id="buy-text">ACHETER</span>
                </button>
                <button id="sell-btn" class="sell-btn p-4 rounded-lg text-xl font-bold text-white">
                    <i class="fas fa-arrow-down mr-2"></i> <span id="sell-text">VENDRE</span>
                </button>
            </div>
            
            <!-- R√âSUM√â DU TRADE -->
            <div id="trade-summary" class="mt-6 bg-black/50 p-4 rounded hidden">
                <h4 class="text-lg font-bold mb-2 text-yellow-400" id="summary-title">R√©sum√© du Trade</h4>
                <div class="grid grid-cols-2 gap-2 text-sm">
                    <p><span id="summary-asset">Actif:</span> <span id="trade-asset"></span></p>
                    <p><span id="summary-side">Direction:</span> <span id="trade-side"></span></p>
                    <p><span id="summary-quantity">Quantit√©:</span> <span id="trade-quantity"></span></p>
                    <p><span id="summary-price">Prix:</span> <span id="trade-price"></span></p>
                    <p><span id="summary-total">Total:</span> <span id="trade-total"></span></p>
                </div>
                <button id="confirm-trade-btn" class="w-full mt-3 p-3 bg-green-600 rounded font-bold">
                    <span id="confirm-trade-text">Confirmer le Trade</span>
                </button>
            </div>
        </div>
        
        <!-- PORTFOLIO ET SOLDE -->
        <div class="bg-gray-900 p-6 rounded-lg border-2 border-purple-500">
            <h3 class="text-xl font-bold mb-4 text-purple-400" id="portfolio-title">Votre Portfolio</h3>
            
            <button id="connect-wallet-btn" class="w-full px-6 py-3 bg-purple-600 rounded-lg font-bold mb-4">
                Connecter MetaMask
            </button>
            
            <div id="portfolio-details" class="hidden space-y-4">
                <!-- SOLDE USDT -->
                <div class="bg-black/50 p-3 rounded">
                    <p class="text-gray-400 text-sm">Solde USDT</p>
                    <p id="usdt-bal" class="text-2xl font-bold text-green-400">10,000.00</p>
                </div>
                
                <!-- ACTIFS D√âTENUS -->
                <div class="bg-black/50 p-3 rounded">
                    <p class="text-gray-400 text-sm mb-2">Vos Actifs</p>
                    <div id="assets-list" class="space-y-2">
                        <!-- Rempli dynamiquement -->
                    </div>
                </div>
                
                <!-- PERFORMANCE -->
                <div class="bg-black/50 p-3 rounded">
                    <p class="text-gray-400 text-sm">Performance</p>
                    <p id="portfolio-perf" class="text-xl font-bold text-green-400">+0.00%</p>
                    <p id="pnl" class="text-sm text-gray-400">PNL: $0.00</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- HISTORIQUE DES TRADES -->
<section class="container mx-auto p-8">
    <div class="bg-gray-900 p-6 rounded-lg border-2 border-yellow-500">
        <h3 class="text-2xl font-bold mb-4 text-yellow-400" id="history-title">üìä Historique de vos Trades</h3>
        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-gray-700">
                        <th class="p-2 text-left" id="th-date">Date</th>
                        <th class="p-2 text-left" id="th-pair">Paire</th>
                        <th class="p-2 text-left" id="th-type">Type</th>
                        <th class="p-2 text-left" id="th-side">Side</th>
                        <th class="p-2 text-left" id="th-quantity">Quantit√©</th>
                        <th class="p-2 text-left" id="th-price">Prix</th>
                        <th class="p-2 text-left" id="th-total">Total</th>
                        <th class="p-2 text-left" id="th-status">Statut</th>
                    </tr>
                </thead>
                <tbody id="trades-history">
                    <!-- Rempli automatiquement -->
                </tbody>
            </table>
        </div>
    </div>
</section>

<!-- SECTION IA TRADING -->
<section class="container mx-auto p-8">
    <h2 class="text-4xl font-bold mb-8 text-center text-blue-400" id="ia-title">ü§ñ Intelligence Artificielle Trading</h2>
    
    <!-- ABONNEMENT BLOQU√â -->
    <div class="bg-yellow-900/50 border-2 border-yellow-500 p-6 rounded-lg mb-8 text-center">
        <h3 class="text-2xl font-bold mb-4">üîí Acc√®s IA Premium</h3>
        <p class="text-lg mb-4" id="premium-desc">Signaux IA en temps r√©el, analyses techniques, pr√©dictions machine learning</p>
        <div class="bg-black/50 p-4 rounded mb-4">
            <p class="text-sm text-gray-400">Prix: <strong class="text-yellow-400">99‚Ç¨ / mois</strong></p>
            <p class="text-sm text-gray-400" id="premium-includes">Inclus: API IA, dashboard complet, support Telegram</p>
        </div>
        <button id="subscribe-btn" class="px-8 py-3 bg-yellow-600 rounded-lg text-xl font-bold cursor-not-allowed" disabled>
            ‚è≥ ATTENTE LICENCE - D√âSACTIV√â
        </button>
    </div>

    <!-- DASHBOARD IA -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- CARTE SIGNAL IA -->
        <div class="lg:col-span-2 bg-gray-900 p-6 rounded-lg border-2 border-blue-500">
            <h3 class="text-2xl font-bold mb-6 text-blue-400" id="signal-title">Signal IA en Temps R√©el</h3>
            
            <!-- GRAPHIQUE -->
            <div class="bg-black p-4 rounded mb-6">
                <div id="tradingview-chart" style="height: 300px;" class="flex items-center justify-center text-gray-500">
                    <div class="text-center">
                        <p class="text-lg mb-2">üìä Graphique TradingView</p>
                        <p class="text-sm">(Activ√© avec licence premium)</p>
                        <div class="mt-4 candlestick w-full h-32 opacity-30"></div>
                    </div>
                </div>
            </div>
            
            <!-- SIGNAL IA D√âTAILL√â -->
            <div class="text-center p-8 bg-black/50 rounded-lg border border-green-500 mb-6">
                <div id="ai-main-icon" class="text-6xl mb-4">ü§ñ</div>
                <div id="ai-main-signal" class="text-4xl font-bold neon-green mb-2">BUY ZND</div>
                <div class="text-xl text-gray-400 mb-4">Confiance IA: <span id="ai-main-confidence" class="text-yellow-400">87%</span></div>
                <div class="bg-black/70 p-4 rounded-lg text-sm space-y-2">
                    <p><strong id="reason-label">Raison:</strong> <span id="ai-reason">Analyse technique bullish + volume haussier</span></p>
                    <p><strong id="entry-label">Entry:</strong> <span id="ai-entry">$0.0025</span> | <strong id="stoploss-label">Stop Loss:</strong> <span id="ai-sl">$0.0022</span> | <strong id="target-label">Target:</strong> <span id="ai-tp">$0.0030</span></p>
                </div>
                <button id="execute-ai-trade" class="mt-4 px-6 py-3 bg-blue-600 rounded-lg font-bold">
                    <i class="fas fa-robot mr-2"></i> Ex√©cuter Trade IA
                </button>
            </div>
        </div>

        <!-- STATISTIQUES PERFORMANCE -->
        <div class="bg-gray-900 p-6 rounded-lg border-2 border-purple-500">
            <h3 class="text-xl font-bold mb-4 text-purple-400">üìà Performance IA</h3>
            <div class="space-y-4">
                <div class="bg-black/50 p-4 rounded">
                    <p class="text-gray-400 text-sm">Taux de R√©ussite</p>
                    <p class="text-3xl font-bold text-green-400">76.4%</p>
                </div>
                <div class="bg-black/50 p-4 rounded">
                    <p class="text-gray-400 text-sm">Trades Gagnants</p>
                    <p class="text-3xl font-bold text-green-400">42</p>
                </div>
                <div class="bg-black/50 p-4 rounded">
                    <p class="text-gray-400 text-sm">Trades Perdants</p>
                    <p class="text-3xl font-bold text-red-400">13</p>
                </div>
                <div class="bg-black/50 p-4 rounded">
                    <p class="text-gray-400 text-sm">Profit Total</p>
                    <p class="text-3xl font-bold text-yellow-400">+$2,458</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- FOOTER -->
<footer class="container mx-auto p-8 mt-12 border-t border-gray-700 text-center">
    <p class="text-gray-500 text-sm">¬© 2025 ProfitAI.io - PLATEFORME DE TRADING SIMUL√â - PAS DE CONSEIL FINANCIER</p>
</footer>

<!-- JAVASCRIPT TRADING -->
<script>
// ===== TRADUCTIONS =====
const translations = {
    fr: {
        tradingTitle: "üíπ Plateforme de Trading Simul√©",
        tradePanelTitle: "Ex√©cuter un Trade",
        assetLabel: "Actif √† trader",
        orderTypeLabel: "Type d'ordre",
        priceLabelTrade: "Prix Limite (USDT)",
        quantityLabel: "Quantit√©",
        buyText: "ACHETER",
        sellText: "VENDRE",
        summaryTitle: "R√©sum√© du Trade",
        summaryAsset: "Actif:",
        summarySide: "Direction:",
        summaryQuantity: "Quantit√©:",
        summaryPrice: "Prix:",
        summaryTotal: "Total:",
        confirmTradeText: "Confirmer le Trade",
        portfolioTitle: "Votre Portfolio",
        connectWallet: "Connecter MetaMask",
        historyTitle: "üìä Historique de vos Trades",
        thDate: "Date",
        thPair: "Paire",
        thType: "Type",
        thSide: "Side",
        thQuantity: "Quantit√©",
        thPrice: "Prix",
        thTotal: "Total",
        thStatus: "Statut"
    },
    en: {
        tradingTitle: "üíπ Simulated Trading Platform",
        tradePanelTitle: "Execute Trade",
        assetLabel: "Asset to trade",
        orderTypeLabel: "Order type",
        priceLabelTrade: "Limit Price (USDT)",
        quantityLabel: "Quantity",
        buyText: "BUY",
        sellText: "SELL",
        summaryTitle: "Trade Summary",
        summaryAsset: "Asset:",
        summarySide: "Side:",
        summaryQuantity: "Quantity:",
        summaryPrice: "Price:",
        summaryTotal: "Total:",
        confirmTradeText: "Confirm Trade",
        portfolioTitle: "Your Portfolio",
        connectWallet: "Connect MetaMask",
        historyTitle: "üìä Your Trades History",
        thDate: "Date",
        thPair: "Pair",
        thType: "Type",
        thSide: "Side",
        thQuantity: "Quantity",
        thPrice: "Price",
        thTotal: "Total",
        thStatus: "Status"
    },
    ru: {
        tradingTitle: "üíπ –¢–æ—Ä–≥–æ–≤–∞—è –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ (–°–∏–º—É–ª—è—Ü–∏—è)",
        tradePanelTitle: "–í—ã–ø–æ–ª–Ω–∏—Ç—å –°–¥–µ–ª–∫—É",
        assetLabel: "–ê–∫—Ç–∏–≤ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏",
        orderTypeLabel: "–¢–∏–ø –æ—Ä–¥–µ—Ä–∞",
        priceLabelTrade: "–õ–∏–º–∏—Ç–Ω–∞—è –¶–µ–Ω–∞ (USDT)",
        quantityLabel: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",
        buyText: "–ö–£–ü–ò–¢–¨",
        sellText: "–ü–†–û–î–ê–¢–¨",
        summaryTitle: "–°–≤–æ–¥–∫–∞ –°–¥–µ–ª–∫–∏",
        summaryAsset: "–ê–∫—Ç–∏–≤:",
        summarySide: "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:",
        summaryQuantity: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:",
        summaryPrice: "–¶–µ–Ω–∞:",
        summaryTotal: "–í—Å–µ–≥–æ:",
        confirmTradeText: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –°–¥–µ–ª–∫—É",
        portfolioTitle: "–í–∞—à –ü–æ—Ä—Ç—Ñ–µ–ª—å",
        connectWallet: "–ü–æ–¥–∫–ª—é—á–∏—Ç—å MetaMask",
        historyTitle: "üìä –ò—Å—Ç–æ—Ä–∏—è –í–∞—à–∏—Ö –°–¥–µ–ª–æ–∫",
        thDate: "–î–∞—Ç–∞",
        thPair: "–ü–∞—Ä–∞",
        thType: "–¢–∏–ø",
        thSide: "–°—Ç–æ—Ä–æ–Ω–∞",
        thQuantity: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",
        thPrice: "–¶–µ–Ω–∞",
        thTotal: "–í—Å–µ–≥–æ",
        thStatus: "–°—Ç–∞—Ç—É—Å"
    }
};

// ===== √âTAT GLOBAL =====
let userPortfolio = {
    USDT: 10000.00,
    assets: {
        ZND: { amount: 0, avgPrice: 0 },
        BTC: { amount: 0, avgPrice: 0 },
        ETH: { amount: 0, avgPrice: 0 },
        BNB: { amount: 0, avgPrice: 0 }
    }
};

let currentPrices = {
    ZND: 0.0025,
    BTC: 45000,
    ETH: 3000,
    BNB: 350
};

let tradesHistory = [];

// ===== INITIALISATION =====
document.addEventListener('DOMContentLoaded', function() {
    updateLanguage('fr');
    initializeTrading();
    updatePortfolioDisplay();
    generateTradesHistory();
    
    // Mettre √† jour les prix en temps r√©el
    setInterval(updatePrices, 3000);
});

// ===== FONCTIONS DE TRADUCTION =====
function updateLanguage(lang) {
    // Mettre √† jour tous les textes avec les traductions
    Object.keys(translations[lang]).forEach(key => {
        const element = document.getElementById(key);
        if (element) element.textContent = translations[lang][key];
    });
}

// ===== INITIALISATION TRADING =====
function initializeTrading() {
    // Gestion du type d'ordre
    document.getElementById('order-type').addEventListener('change', function(e) {
        const priceContainer = document.getElementById('price-input-container');
        if (e.target.value === 'limit') {
            priceContainer.classList.remove('hidden');
        } else {
            priceContainer.classList.add('hidden');
        }
    });

    // Boutons d'achat/vente
    document.getElementById('buy-btn').addEventListener('click', () => prepareTrade('buy'));
    document.getElementById('sell-btn').addEventListener('click', () => prepareTrade('sell'));
    
    // Confirmation de trade
    document.getElementById('confirm-trade-btn').addEventListener('click', executeTrade);
    
    // Connexion wallet
    document.getElementById('connect-wallet-btn').addEventListener('click', connectWallet);
    
    // Trade IA
    document.getElementById('execute-ai-trade').addEventListener('click', executeAITrade);
    
    // S√©lecteur de langue
    document.getElementById('lang-select').addEventListener('change', (e) => {
        updateLanguage(e.target.value);
    });
}

// ===== PR√âPARATION DU TRADE =====
function prepareTrade(side) {
    const asset = document.getElementById('asset-select').value;
    const orderType = document.getElementById('order-type').value;
    const quantity = parseFloat(document.getElementById('quantity').value);
    
    if (quantity <= 0) {
        alert("Veuillez entrer une quantit√© valide");
        return;
    }
    
    let price;
    if (orderType === 'market') {
        price = currentPrices[asset];
    } else {
        price = parseFloat(document.getElementById('limit-price').value);
        if (price <= 0) {
            alert("Veuillez entrer un prix limite valide");
            return;
        }
    }
    
    const total = quantity * price;
    
    // V√©rifier les fonds
    if (side === 'buy' && total > userPortfolio.USDT) {
        alert("Fonds insuffisants en USDT");
        return;
    }
    
    if (side === 'sell' && quantity > userPortfolio.assets[asset].amount) {
        alert(`Quantit√© insuffisante de ${asset}`);
        return;
    }
    
    // Afficher le r√©sum√©
    document.getElementById('trade-asset').textContent = asset;
    document.getElementById('trade-side').textContent = side === 'buy' ? 'ACHAT' : 'VENTE';
    document.getElementById('trade-side').className = side === 'buy' ? 'text-green-400' : 'text-red-400';
    document.getElementById('trade-quantity').textContent = quantity;
    document.getElementById('trade-price').textContent = '$' + price.toFixed(4);
    document.getElementById('trade-total').textContent = '$' + total.toFixed(2);
    
    document.getElementById('trade-summary').classList.remove('hidden');
    
    // Stocker les donn√©es du trade en cours
    window.currentTrade = { asset, side, orderType, quantity, price, total };
}

// ===== EX√âCUTION DU TRADE =====
function executeTrade() {
    const trade = window.currentTrade;
    
    if (trade.side === 'buy') {
        // Achat
        userPortfolio.USDT -= trade.total;
        userPortfolio.assets[trade.asset].amount += trade.quantity;
        userPortfolio.assets[trade.asset].avgPrice = trade.price;
    } else {
        // Vente
        userPortfolio.USDT += trade.total;
        userPortfolio.assets[trade.asset].amount -= trade.quantity;
    }
    
    // Ajouter √† l'historique
    tradesHistory.unshift({
        id: Date.now(),
        date: new Date(),
        asset: trade.asset,
        side: trade.side,
        type: trade.orderType,
        quantity: trade.quantity,
        price: trade.price,
        total: trade.total,
        status: 'filled'
    });
    
    // Mettre √† jour l'affichage
    updatePortfolioDisplay();
    generateTradesHistory();
    
    // Cacher le r√©sum√©
    document.getElementById('trade-summary').classList.add('hidden');
    
    // Notification
    showNotification(`Trade ex√©cut√©: ${trade.side.toUpperCase()} ${trade.quantity} ${trade.asset}`, 'success');
}

// ===== EX√âCUTION TRADE IA =====
function executeAITrade() {
    const aiSignal = document.getElementById('ai-main-signal').textContent;
    const [action, asset] = aiSignal.split(' ');
    
    if (action !== 'BUY' && action !== 'SELL') {
        alert("Signal IA non valide pour le trading");
        return;
    }
    
    // Pr√©-remplir le formulaire avec le signal IA
    document.getElementById('asset-select').value = asset;
    document.getElementById('quantity').value = (action === 'BUY' ? 100 : 50); // Quantit√© par d√©faut
    
    // Pr√©parer le trade
    prepareTrade(action.toLowerCase());
    
    showNotification(`Trade IA pr√©par√©: ${action} ${asset}`, 'info');
}

// ===== CONNEXION WALLET =====
async function connectWallet() {
    if (!window.ethereum) {
        alert("MetaMask non d√©tect√© ! Veuillez installer l'extension.");
        return;
    }
    
    try {
        const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
        const addr = accounts[0];
        
        // Mettre √† jour le bouton
        document.getElementById('connect-wallet-btn').textContent = 
            `${addr.slice(0,6)}...${addr.slice(-4)}`;
        document.getElementById('connect-wallet-btn').classList.add('bg-green-600');
        
        // Afficher le portfolio
        document.getElementById('portfolio-details').classList.remove('hidden');
        
        showNotification("Wallet connect√© avec succ√®s", 'success');
        
    } catch (error) {
        console.error("Erreur connexion wallet:", error);
        alert("Erreur lors de la connexion au wallet");
    }
}

// ===== MISE √Ä JOUR PORTFOLIO =====
function updatePortfolioDisplay() {
    // Solde USDT
    document.getElementById('usdt-bal').textContent = userPortfolio.USDT.toFixed(2);
    
    // Liste des actifs
    const assetsList = document.getElementById('assets-list');
    assetsList.innerHTML = '';
    
    Object.keys(userPortfolio.assets).forEach(asset => {
        const holding = userPortfolio.assets[asset];
        if (holding.amount > 0) {
            const value = holding.amount * currentPrices[asset];
            const pnl = ((currentPrices[asset] - holding.avgPrice) / holding.avgPrice * 100);
            
            const assetDiv = document.createElement('div');
            assetDiv.className = 'flex justify-between items-center';
            assetDiv.innerHTML = `
                <span class="font-bold">${asset}</span>
                <div class="text-right">
                    <div>${holding.amount.toFixed(4)}</div>
                    <div class="text-xs ${pnl >= 0 ? 'text-green-400' : 'text-red-400'}">
                        ${pnl >= 0 ? '+' : ''}${pnl.toFixed(2)}%
                    </div>
                </div>
            `;
            assetsList.appendChild(assetDiv);
        }
    });
    
    // Performance totale
    const totalValue = Object.keys(userPortfolio.assets).reduce((total, asset) => {
        return total + (userPortfolio.assets[asset].amount * currentPrices[asset]);
    }, userPortfolio.USDT);
    
    const initialValue = 10000; // Valeur initiale fixe
    const perf = ((totalValue - initialValue) / initialValue * 100);
    
    document.getElementById('portfolio-perf').textContent = 
        `${perf >= 0 ? '+' : ''}${perf.toFixed(2)}%`;
    document.getElementById('portfolio-perf').className = 
        `text-xl font-bold ${perf >= 0 ? 'text-green-400' : 'text-red-400'}`;
    
    document.getElementById('pnl').textContent = 
        `PNL: $${(totalValue - initialValue).toFixed(2)}`;
}

// ===== HISTORIQUE DES TRADES =====
function generateTradesHistory() {
    const tbody = document.getElementById('trades-history');
    tbody.innerHTML = '';
    
    tradesHistory.slice(0, 10).forEach(trade => {
        const row = document.createElement('tr');
        row.className = 'border-b border-gray-800 hover:bg-gray-800/30';
        row.innerHTML = `
            <td class="p-2">${trade.date.toLocaleString()}</td>
            <td class="p-2 font-bold">${trade.asset}/USDT</td>
            <td class="p-2">${trade.type}</td>
            <td class="p-2 font-bold ${trade.side === 'buy' ? 'text-green-400' : 'text-red-400'}">
                ${trade.side.toUpperCase()}
            </td>
            <td class="p-2">${trade.quantity}</td>
            <td class="p-2">$${trade.price.toFixed(4)}</td>
            <td class="p-2">$${trade.total.toFixed(2)}</td>
            <td class="p-2">
                <span class="px-2 py-1 rounded text-xs ${trade.status === 'filled' ? 'bg-green-900 text-green-300' : 'bg-yellow-900 text-yellow-300'}">
                    ${trade.status}
                </span>
            </td>
        `;
        tbody.appendChild(row);
    });
}

// ===== MISE √Ä JOUR DES PRIX =====
function updatePrices() {
    // Simuler des variations de prix al√©atoires
    Object.keys(currentPrices).forEach(asset => {
        const change = (Math.random() - 0.5) * 0.1; // ¬±5%
        currentPrices[asset] *= (1 + change);
        
        // Mettre √† jour l'affichage du prix ZND
        if (asset === 'ZND') {
            document.getElementById('znd-price').textContent = 
                '$' + currentPrices[asset].toFixed(4);
        }
    });
    
    // Mettre √† jour le portfolio si connect√©
    if (!document.getElementById('portfolio-details').classList.contains('hidden')) {
        updatePortfolioDisplay();
    }
}

// ===== NOTIFICATIONS =====
function showNotification(message, type = 'info') {
    // Cr√©er une notification temporaire
    const notification = document.createElement('div');
    notification.className = `fixed top-20 right-4 p-4 rounded-lg z-50 ${
        type === 'success' ? 'bg-green-900 text-green-300' : 
        type === 'error' ? 'bg-red-900 text-red-300' : 
        'bg-blue-900 text-blue-300'
    }`;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    // Supprimer apr√®s 3 secondes
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// ===== G√âN√âRATEUR DE SIGNAL IA =====
function generateSignal() {
    const signals = ['
